# 设计API文档
本文档用于统一API的开发与使用，详细到每个模块的设计，功能，作用等

# 注册/登陆账号
注册管理员账号，将代表 `智能家居` 管理权限中，等级最高的用户一位 \
权限等级将分为以下阶段:
- 管理员
- 普通用户
- 游客用户
- 不明用户

`管理员` 将拥有最高的权限等级 (权限等级4) \
`普通用户` 是指家庭成员等 (权限等级3) \
`游客用户` 是指非家庭成员的身份，所获得的权限仅限制于连接Wi-Fi等 (权限等级2) \
`不明用户` 是指未被认证的用户，不给予对家庭智能设备的任意管控 (权限等级1)


## 数据库设计

| 名称               | 类型     | 事例参数                       | 备注              |
|------------------|--------|----------------------------|-----------------|
| id               | int    | 1                          | 证明身份的唯一数值       |
| account          | string | Furry-yide                 | 账号名称            |
| password         | string | Dede200822                 | 登陆密码            |
| registrationTime | int    | 1742659200                 | 注册的时间(使用Unix存储) |
| loginTime        | int    | 1742659200                 | 登陆时间(使用Unix存储)  |
| privileges       | int    | 4                          | 用户权限等级          |
| condition        | int    | 0                          | 状态码(0启用，1禁用)    |
| voucher          | string | T32AVdjh1aIi85OpS3DrOXCbYu | 身份凭证            |

## 请求数据
| 名称               | 类型     | 事例参数       | 备注              |
|------------------|--------|------------|-----------------|
| account          | string | Furry-yide | 账号名称            |
| password         | string | Dede200822 | 登陆密码            |
| privileges       | int    | 1          | 用户权限等级          |
如果用户不存在，将会自动创建用户
> `用户权限等级` 默认是 `不明用户(权限等级1)`。但是在注册请求中，可以手动带上 `privileges` 参数，来定义新注册的用户账号等级(仅限制于管理员操作有效)


## 响应数据
| 名称               | 类型     | 事例参数                       | 备注              |
|------------------|--------|----------------------------|-----------------|
| code             | string | 1200                       | 返回码             |
| msg              | string | OK                         | 额外备注            |
| id               | int    | 1                          | 证明身份的唯一数值       |
| account          | string | Furry-yide                 | 账号名称            |
| registrationTime | int    | 1742659200                 | 注册的时间(使用Unix存储) |
| loginTime        | int    | 1742659200                 | 登陆时间(使用Unix存储)  |
| privileges       | int    | 1                          | 用户权限等级          |
| token            | string | T32AVdjh1aIi85OpS3DrOXCbYu | 用户身份鉴权          |

<hr>

# 身份鉴权
用于验证用户ToKen是否有效

## 请求数据
| 名称      | 类型     | 事例参数                       | 备注     |
|---------|--------|----------------------------|--------|
| account | string | Furry-yide                 | 账号名称   |
| token   | string | T32AVdjh1aIi85OpS3DrOXCbYu | 用户身份鉴权 |

## 响应数据 
| 名称             | 类型     | 事例参数                       | 备注                    |
|----------------|--------|----------------------------|-----------------------|
| code           | string | 1200                       | 返回码                   |
| msg            | string | OK                         | 额外备注                  |
| token          | string | T32AVdjh1aIi85OpS3DrOXCbYu | 用户身份鉴权                |
| expirationTime | int    | 3600                       | 过期剩余时间(每小时将更新一次token) |

<hr>

# 执行行为
设定每个用户可执行的行为与事件

## 请求数据
| 名称      | 类型     | 事例参数                       | 备注     |
|---------|--------|----------------------------|--------|
| msg     | string | OK                         | 额外备注   |
| token   | string | T32AVdjh1aIi85OpS3DrOXCbYu | 用户身份鉴权 |
| actions | string | openDoor                   | 事件执行   |


> 将 `Token` 放在请求头（如 Authorization: Bearer <token>）
 
## 响应数据
| 名称   | 类型     | 事例参数 | 备注   |
|------|--------|------|------|
| code | string | 1200 | 返回码  |
| msg  | string | OK   | 额外备注 |